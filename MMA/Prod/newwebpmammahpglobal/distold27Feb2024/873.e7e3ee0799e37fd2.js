"use strict";(self.webpackChunknewwebpmammahp=self.webpackChunknewwebpmammahp||[]).push([[873],{9873:(M,p,s)=>{s.r(p),s.d(p,{AuthModule:()=>x});var h=s(9808),l=s(6696),e=s(4893);let f=(()=>{class n{constructor(){}ngOnInit(){}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275cmp=e.\u0275\u0275defineComponent({type:n,selectors:[["app-auth-layout"]],decls:1,vars:0,template:function(t,o){1&t&&e.\u0275\u0275element(0,"router-outlet")},directives:[l.lC],styles:[""]}),n})();var v=s(1816),g=s(2340),u=s(9869),y=s(7420),S=s(1413),b=s(3525);const C=[{path:"",component:f,children:[{path:"",redirectTo:"home",pathMatch:"full"},{path:"home",component:(()=>{class n{constructor(t,o){this.router=t,this.route=o,this.appId=""}ngOnInit(){this.route.queryParamMap.subscribe(o=>{o.params.ssid?localStorage.setItem("ssid",o.params.ssid):localStorage.setItem("ssid",null),o.params.app?(this.appId=o.params.app,localStorage.setItem("app",o.params.app)):(this.appId="",localStorage.setItem("app",this.appId)),o.params.connid?localStorage.setItem("connid",o.params.connid):localStorage.setItem("connid",g.N.orgConnectionCode),o.params.sid?localStorage.setItem("sid",o.params.sid):localStorage.setItem("sid",""),o.params.type?localStorage.setItem("surveyType",o.params.type):localStorage.setItem("surveyType",""),o.params.qid?localStorage.setItem("qid",o.params.qid):localStorage.setItem("qid","")});let t=setTimeout(()=>{this.router.navigateByUrl("auth/login"),clearInterval(t)},2e3)}}return n.\u0275fac=function(t){return new(t||n)(e.\u0275\u0275directiveInject(l.F0),e.\u0275\u0275directiveInject(l.gz))},n.\u0275cmp=e.\u0275\u0275defineComponent({type:n,selectors:[["app-splash-screen"]],decls:20,vars:1,consts:[[1,"container","splash-screen"],[1,"total-cont"],[1,"row","text-center"],[1,"col-md-12"],["src","../../../assets/media/handLogo.png","alt","",1,"img-fluid"],[1,"row"],[1,"col-md-12","text-center"],[1,"pb-3"],[1,"row","text-center","bottom-position","mb-5","pb-5"],[1,"pb-3","powered"],["src","../../../assets/media/Logo1.png","alt","",1,"img-fluid","q-pr-12"],["src","../../../assets/media/Logo2.png","alt","",1,"img-fluid","q-pr-12"],["src","../../../assets/media/Logo3.png","alt","",1,"img-fluid","q-pr-12"],["src","../../../assets/media/Logo4.png","alt","",1,"img-fluid"]],template:function(t,o){1&t&&(e.\u0275\u0275elementStart(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3),e.\u0275\u0275element(4,"img",4),e.\u0275\u0275elementEnd()(),e.\u0275\u0275elementStart(5,"div",5)(6,"div",6)(7,"h1",7),e.\u0275\u0275text(8),e.\u0275\u0275element(9,"br"),e.\u0275\u0275text(10," Survey"),e.\u0275\u0275elementEnd()()()(),e.\u0275\u0275elementStart(11,"div",8)(12,"div",6)(13,"p",9),e.\u0275\u0275text(14,"Powered by"),e.\u0275\u0275elementEnd()(),e.\u0275\u0275elementStart(15,"div",3),e.\u0275\u0275element(16,"img",10)(17,"img",11)(18,"img",12)(19,"img",13),e.\u0275\u0275elementEnd()()()),2&t&&(e.\u0275\u0275advance(8),e.\u0275\u0275textInterpolate1("","mmind"==o.appId?"Farmer ":"Worker "," Voice "))},styles:[".splash-screen[_ngcontent-%COMP%]{z-index:999999999999;position:fixed;background-color:#fff;inset:75px 0 0}.splash-screen[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{font-size:30px;color:#ad0c62;font-weight:300}.splash-screen[_ngcontent-%COMP%]   .bottom-position[_ngcontent-%COMP%]{position:fixed;bottom:0;left:0;right:0}.splash-screen[_ngcontent-%COMP%]   .bottom-position[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%]{position:absolute;bottom:25px;left:0;right:0;color:#fff;font-weight:700;text-shadow:0px 0px 5px rgba(0,0,0,.1)}.q-pr-12[_ngcontent-%COMP%]{padding-right:12px}.powered[_ngcontent-%COMP%]{font-size:24px;color:#ad0c62;font-weight:300}"]}),n})()},{path:"login",component:(()=>{class n{constructor(t,o,a,i,d){this.router=t,this.sharedService=o,this.dashboardService=a,this.surveyService=i,this.route=d,this.subscriptions=[],this.tenantsList=[],this.isRedirectedFromOAuthOrAlreadyLoggedIn=!1,this.loggedIn=!1,this.loginScreenRedirection()}ngOnInit(){}login(){this.loginScreenRedirection()}loginScreenRedirection(){var a=this.getWindowsObject().location.href;a.includes("idToken")&&a.includes("refreshToken")&&this.route.queryParams.subscribe(i=>{this.storeTokensInLocalstorage(i.idToken,i.refreshToken)}),this.sharedService.startLoader(),u.g.currentSession().then(i=>{console.log("id token =  "),console.log(i.getIdToken().getJwtToken()),this.sharedService.stopLoader();const d=i.getIdToken().payload.BlueNumber;localStorage.setItem("personBluenumber",d),localStorage.setItem("idToken",i.getIdToken().getJwtToken()),this.getConnectionSurveyDetails()}).catch(i=>{console.log(i),this.sharedService.stopLoader(),this.goToSSOWebsite()})}getUserDetails(){let t=localStorage.getItem("personBluenumber");null!=t&&""!=t?this.router.navigateByUrl("agreement"):this.logout()}getConnectionSurveyDetails(){let t=localStorage.getItem("connid");null!=t?(this.sharedService.startLoader(),this.surveyService.getConnectionRequestDetailsByCode(t).subscribe(o=>{this.sharedService.stopLoader(),o.result.connected?(localStorage.setItem("IsUserConnected",o.result.connected),"verify"==localStorage.getItem("surveyType")?this.router.navigateByUrl("home/info"):this.router.navigateByUrl("home/language")):this.router.navigateByUrl(`home/accept/${o.result.name}`)})):this.logout()}logout(){localStorage.clear(),localStorage.removeItem("idToken"),u.g.signOut()}getWindowsObject(){return window}ngOnDestroy(){this.subscriptions.forEach(t=>t.unsubscribe())}goToSSOWebsite(){window.location.href=g.N.BlueNumberCognitoAmplifyUrl+"?returnUrl="+g.N.BlueNumberCognitoReturnUrl}storeTokensInLocalstorage(t,o){var a=this.getDecodedAccessToken(t);const i=a.phone_number,d=a.phone_number_verified,c=a.sub;var m=g.N.cognito.userPoolWebClientId;localStorage.setItem("amplify-signin-with-hostedUI","false"),localStorage.setItem(`CognitoIdentityServiceProvider.${m}.LastAuthUser`,`${c}`),localStorage.setItem(`CognitoIdentityServiceProvider.${m}.${c}.refreshToken`,o),localStorage.setItem(`CognitoIdentityServiceProvider.${m}.${c}.userData`,`{"MFAOptions":[{"AttributeName":"${i}","DeliveryMedium":"SMS"}],"UserAttributes":[{"Name":"sub","Value":"${c}"},{"Name":"phone_number_verified","Value":"${d}"},{"Name":"phone_number","Value":"${i}"}],"Username":"${c}"}`),localStorage.setItem(`CognitoIdentityServiceProvider.${m}.${c}.idToken`,t)}getDecodedAccessToken(t){try{return(0,v.Z)(t)}catch(o){return null}}}return n.\u0275fac=function(t){return new(t||n)(e.\u0275\u0275directiveInject(l.F0),e.\u0275\u0275directiveInject(y.F),e.\u0275\u0275directiveInject(S.s),e.\u0275\u0275directiveInject(b.F),e.\u0275\u0275directiveInject(l.gz))},n.\u0275cmp=e.\u0275\u0275defineComponent({type:n,selectors:[["app-login"]],decls:17,vars:0,consts:[[1,"login","screen-bg"],[1,"row","pb-3"],[1,"col-12"],["src","../../../assets/media/handLogo.png","alt","",1,"img-fluid"],[1,"row","pb-5"],[1,"side-title"],[1,"row"],[1,"sub-text"],[1,"pb-3"]],template:function(t,o){1&t&&(e.\u0275\u0275elementStart(0,"body")(1,"div",0)(2,"div",1)(3,"div",2),e.\u0275\u0275element(4,"img",3),e.\u0275\u0275elementEnd()(),e.\u0275\u0275elementStart(5,"div",4)(6,"div",2)(7,"div",5),e.\u0275\u0275text(8," Loading "),e.\u0275\u0275elementEnd()()(),e.\u0275\u0275elementStart(9,"div",6)(10,"div",2)(11,"div",7)(12,"div",8),e.\u0275\u0275text(13," Please wait while redirecting..."),e.\u0275\u0275elementEnd(),e.\u0275\u0275element(14,"br"),e.\u0275\u0275elementStart(15,"div"),e.\u0275\u0275text(16," This may take time. If stuck, wait 2 mins and reload the page or click again on the same link."),e.\u0275\u0275elementEnd()()()()()())},styles:[".login[_ngcontent-%COMP%]{display:grid;grid-template-columns:1fr 1fr}.screen-bg[_ngcontent-%COMP%]{padding:0 15px;display:flex!important;flex-direction:column;justify-content:center;height:100vh}.btn-login[_ngcontent-%COMP%]{border:none;padding:10px;color:#fff;position:absolute;width:157px;height:47px;cursor:pointer;background:#1a1db2;border-radius:6px;bottom:10px}.side-title[_ngcontent-%COMP%]{font-family:Lato,sans-serif!important;font-size:30px;font-style:normal;font-weight:700;color:#ad0c62;text-align:center;margin-top:5px}.login-sub[_ngcontent-%COMP%]{position:relative}.t-center[_ngcontent-%COMP%]{text-align:center}.sub-text[_ngcontent-%COMP%]{color:#ad0c62;font-size:20px;font-weight:700;display:flex;align-items:center;justify-content:center;flex-direction:column;line-height:24px}@media only screen and (min-width: 768px){.login[_ngcontent-%COMP%]{display:flex!important;justify-content:center;align-items:center}}@media only screen and (max-width: 768px){.h100vh[_ngcontent-%COMP%]{min-height:60vh}.login[_ngcontent-%COMP%]{display:block;grid-template-columns:unset;text-align:center;width:100%}.btn-login[_ngcontent-%COMP%]{left:50%;transform:translate(-50%);bottom:25vh}.v-space[_ngcontent-%COMP%]{display:block;grid-template-rows:unset}}@media only screen and (max-width: 567px){.btn-login[_ngcontent-%COMP%]{bottom:5vh}}"]}),n})()},{path:"**",redirectTo:"home",pathMatch:"full"}]}];let I=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=e.\u0275\u0275defineNgModule({type:n}),n.\u0275inj=e.\u0275\u0275defineInjector({imports:[[l.Bz.forChild(C)],l.Bz]}),n})(),x=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=e.\u0275\u0275defineNgModule({type:n}),n.\u0275inj=e.\u0275\u0275defineInjector({imports:[[h.ez,I]]}),n})()}}]);