"use strict";(self.webpackChunknewwebpmammahp=self.webpackChunknewwebpmammahp||[]).push([[278],{7278:(E,M,d)=>{d.r(M),d.d(M,{MySurveysModule:()=>L});var g=d(9808),v=d(6696),e=d(4893);let _=(()=>{class n{constructor(){}ngOnInit(){}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275cmp=e.\u0275\u0275defineComponent({type:n,selectors:[["app-survey-layout"]],decls:1,vars:0,template:function(t,s){1&t&&e.\u0275\u0275element(0,"router-outlet")},directives:[v.lC],styles:[""]}),n})();var C=d(7445),x=d(3525),O=d(7420);function w(n,l){1&n&&(e.\u0275\u0275elementStart(0,"span"),e.\u0275\u0275text(1,"Qualified"),e.\u0275\u0275elementEnd())}function D(n,l){if(1&n&&(e.\u0275\u0275elementStart(0,"span"),e.\u0275\u0275text(1),e.\u0275\u0275element(2,"br"),e.\u0275\u0275text(3),e.\u0275\u0275elementEnd()),2&n){const t=e.\u0275\u0275nextContext(),s=t.index,r=t.$implicit,i=e.\u0275\u0275nextContext();e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate2(" ",s," ",i.getNumberSuffix(s)," Day "),e.\u0275\u0275advance(2),e.\u0275\u0275textInterpolate1(" ",null!=r&&r.isAnswered?"DONE!":""," ")}}function b(n,l){if(1&n&&(e.\u0275\u0275elementStart(0,"div",21)(1,"span"),e.\u0275\u0275text(2),e.\u0275\u0275pipe(3,"date"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(4,"span",22),e.\u0275\u0275text(5),e.\u0275\u0275elementEnd()()),2&n){const t=e.\u0275\u0275nextContext().$implicit;e.\u0275\u0275advance(2),e.\u0275\u0275textInterpolate1(" ",e.\u0275\u0275pipeBind2(3,3,null==t?null:t.answeredTime,"dd MMM y")," "),e.\u0275\u0275advance(3),e.\u0275\u0275textInterpolate2(" ",null==t?null:t.location[0],", ",null==t?null:t.location[1]," ")}}function P(n,l){if(1&n&&(e.\u0275\u0275elementStart(0,"div",17)(1,"div")(2,"div",18),e.\u0275\u0275template(3,w,2,0,"span",19),e.\u0275\u0275template(4,D,4,3,"span",19),e.\u0275\u0275elementEnd()(),e.\u0275\u0275template(5,b,6,6,"div",20),e.\u0275\u0275elementEnd()),2&n){const t=l.$implicit,s=l.index,r=e.\u0275\u0275nextContext();e.\u0275\u0275advance(2),e.\u0275\u0275property("ngClass",0==s?"circle-completed":r.currentSurveyIndex==s&&(null==t||!t.isAnswered)&&r.surveyState<=3?"common-circle-top circle-first-active":null!=t&&t.isAnswered?"common-circle-top circle-final-active":"common-circle-top circle-inactive"),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",0==s),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",0!=s),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",null==t?null:t.answeredTime)}}const I=[{path:"",component:_,children:[{path:"",redirectTo:"list",pathMatch:"full"},{path:"list",component:(()=>{class n{constructor(t,s,r){this.surveyService=t,this.sharedService=s,this.router=r,this.streakDays=[],this.surveyDetails=[],this.surveyMsg="",this.surveyState=0,this.currentSurveyIndex=0,this.firstSurveyAnswered=!1}ngOnInit(){this.getSurveyListDetails()}getSurveyListDetails(){this.sharedService.startLoader(),("null"==localStorage.getItem("ssid")||""==localStorage.getItem("ssid"))&&(this.sharedService.successErrorMsg.message="Please scan QR code again.",this.sharedService.successErrorMsg.showAcceptReject=!1,this.sharedService.successErrorMsg.showProceed=!1,this.router.navigateByUrl("home/messages")),this.surveyService.getSurveyGroupByQRCode(localStorage.getItem("ssid")).subscribe(t=>{if(this.sharedService.stopLoader(),!t.isError){if(this.surveyDetails=t.result,localStorage.setItem("surveySetId",this.surveyDetails.id),null==this.surveyDetails||this.surveyDetails.surveyGroupItems.length<=0)return this.surveyState=1,void(this.surveyMsg="Surveys are not available");this.surveyDetails.surveyGroupItems.forEach((o,c)=>{0==c&&o.isAnswered&&(this.firstSurveyAnswered=!0)});let s=new Date;s.setHours(0,0,0,0);let r=new Date(this.surveyDetails.endDate);r=new Date(r.getTime()+6e4*r.getTimezoneOffset()),console.log("DATE: ",r);let i=r-s;if(console.log(i),i<0)return this.surveyState=2,void(this.surveyMsg="Survey program ended. We will notify when next program available.");if(0==i&&1==this.surveyDetails.surveyGroupItems[this.surveyDetails.surveyGroupItems.length-1].isAnswered)return this.surveyState=2,void(this.surveyMsg="Survey program ended. We will notify when next program available.");if(this.sortSuveys(),"Hourly"!=this.surveyDetails.type)this.dailySurveySSIDDetails(s);else{let o=new Date;o=new Date(o.getTime()+6e4*o.getTimezoneOffset());let c=new Date(this.surveyDetails.startDate);c=new Date(c.getTime()+6e4*c.getTimezoneOffset());let u=new Date(this.surveyDetails.endDate);u=new Date(u.getTime()+6e4*u.getTimezoneOffset());let m=new Date(this.surveyDetails.surveyGroupItems[0].startDate);m=new Date(m.getTime()+6e4*m.getTimezoneOffset()),m.setHours(0,0,0,0);for(let a=0;a<this.surveyDetails.surveyGroupItems.length;a++)if(!this.surveyDetails.surveyGroupItems[a].isAnswered){if(this.currentSurveyIndex=a,c-o==0){this.surveyState=3,this.surveyMsg="New survey is available!";break}if(u-o>=0){let h,p,f,z=this.surveyDetails.minutesDifference;if(h=this.surveyDetails.surveyGroupItems[a-1],h&&h.answeredTime){p=new Date(h.answeredTime),p=new Date(p.getTime()+6e4*p.getTimezoneOffset()),f=new Date(p.getTime()+60*Number(z)*1e3);let S=f-o;if(S<=0)this.surveyState=3,this.surveyMsg="New survey is available!";else if(S>0){this.surveyState=4,this.showHourlySurveyCounter(f);break}}else this.surveyState=3,this.surveyMsg="New survey is available!";break}return}}}},t=>{"Survey is not found for QR:null"!=t.error.responseException.exceptionMessage?console.log("Error: ",t):this.router.navigateByUrl("home/info")})}dailySurveySSIDDetails(t){for(let s=0;s<this.surveyDetails.surveyGroupItems.length;s++){let r=this.surveyDetails.surveyGroupItems[s];if(0==r.isAnswered){let i=new Date(r.startDate);i=new Date(i.getTime()+6e4*i.getTimezoneOffset()),i.setHours(0,0,0,0);let o=i-t;if(0==o){this.surveyState=3,this.surveyMsg="New survey is available!";break}if(o>0){this.surveyState=4,this.showCounter(r.startDate);break}}}}showHourlySurveyCounter(t){this.timerSubscription=(0,C.F)(1e3).subscribe(s=>{let r,o=0,c=0,u=0,m=0;r=new Date;let a=new Date;a=new Date(a.getTime()+6e4*a.getTimezoneOffset());let y=t-a;y<=0&&this.clearCounter(),o=Math.floor(y/864e5),c=Math.floor(y%864e5/36e5),u=Math.floor(y%36e5/6e4),m=Math.floor(y%6e4/1e3),this.timeCounter=c+"hrs : "+u+"min : "+m+"secs"})}sortSuveys(){return this.surveyDetails.surveyGroupItems.sort((t,s)=>new Date(t.startDate)-new Date(s.startDate))}getNumberSuffix(t){return 1==t?"st":2==t?"nd":3==t?"rd":"th"}showCounter(t){this.timerSubscription=(0,C.F)(1e3).subscribe(s=>{let r,i,o=0,c=0,u=0,m=0;r=new Date,i=new Date(t),i.setHours(0,0,0,0);let a=i-r;a<=0&&this.clearCounter(),o=Math.floor(a/864e5),c=Math.floor(a%864e5/36e5),u=Math.floor(a%36e5/6e4),m=Math.floor(a%6e4/1e3),this.timeCounter=o+"Days : "+c+"Hours : "+u+"Minutes : "+m+"Seconds"})}clearCounter(){this.timerSubscription&&this.timerSubscription.unsubscribe(),this.surveyState=3,this.surveyMsg="New survey is available!"}goBack(){this.router.navigateByUrl("home/info")}getSurveyStyles(){if(this.surveyDetails&&this.surveyDetails.surveyGroupItems){let t=this.surveyDetails.surveyGroupItems.length;if(t<=1)return"height: 0%";{let s=0;return this.surveyDetails.surveyGroupItems.forEach((r,i)=>{i+1<t&&r.isAnswered&&(s+=170)}),`height: ${s}px`}}return"height: 0%"}getVerticalLineStyle(){if(this.surveyDetails&&this.surveyDetails.surveyGroupItems){let t=this.surveyDetails.surveyGroupItems.length;return t<=1?"height: 0%":`height: ${120*t+30*(t-1)}px`}return"height: 0%"}ngOnDestroy(){this.timerSubscription&&this.timerSubscription.unsubscribe()}}return n.\u0275fac=function(t){return new(t||n)(e.\u0275\u0275directiveInject(x.F),e.\u0275\u0275directiveInject(O.F),e.\u0275\u0275directiveInject(v.F0))},n.\u0275cmp=e.\u0275\u0275defineComponent({type:n,selectors:[["app-survey-list"]],decls:20,vars:6,consts:[[1,"pma"],[1,"container"],[1,"my_streaks","mb-5","pb-5"],[1,"row","mb-4"],[1,"col-12","d-flex","align-items-center","justify-content-between"],[1,"pma-heading","text-gray-1"],[1,"fas","fa-chevron-left","mouse-pointer","pe-3",3,"click"],[1,"d-flex","justify-content-end"],["src","../../../../../assets/media/MMlogo-svg.svg","alt","","width","52px","height","auto",1,"img-fluid"],[1,"row"],[1,"col-md-6"],[1,"d-flex","justify-content-center","mt-4"],[1,"position-relative","left-51"],[1,"positioning"],["class","d-flex align-items-center justify-content-between",4,"ngFor","ngForOf"],[1,"vertical-line"],[3,"ngClass"],[1,"d-flex","align-items-center","justify-content-between"],[1,"common-circle",3,"ngClass"],[4,"ngIf"],["class","survey-timedate-fs",4,"ngIf"],[1,"survey-timedate-fs"],[1,"text-truncate","text-wrap"]],template:function(t,s){1&t&&(e.\u0275\u0275elementStart(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"div",4)(5,"div")(6,"h1",5)(7,"i",6),e.\u0275\u0275listener("click",function(){return s.goBack()}),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(8,"span"),e.\u0275\u0275text(9,"My Surveys"),e.\u0275\u0275elementEnd()()(),e.\u0275\u0275elementStart(10,"div",7),e.\u0275\u0275element(11,"img",8),e.\u0275\u0275elementEnd()()(),e.\u0275\u0275elementStart(12,"div",9)(13,"div",10)(14,"div",11)(15,"div",12)(16,"div",13),e.\u0275\u0275template(17,P,6,4,"div",14),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(18,"div",15),e.\u0275\u0275element(19,"div",16),e.\u0275\u0275elementEnd()()()()()()()()),2&t&&(e.\u0275\u0275advance(17),e.\u0275\u0275property("ngForOf",null==s.surveyDetails?null:s.surveyDetails.surveyGroupItems),e.\u0275\u0275advance(1),e.\u0275\u0275styleMap(s.getVerticalLineStyle()),e.\u0275\u0275advance(1),e.\u0275\u0275styleMap(s.getSurveyStyles()),e.\u0275\u0275property("ngClass",s.firstSurveyAnswered?"vertical-line-progress":"line-border"))},directives:[g.sg,g.mk,g.O5],pipes:[g.uU],styles:[".pma[_ngcontent-%COMP%]{padding-top:16px}.pma[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{font-size:24px}.pma-heading[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{color:#545454!important}.pma-heading[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{color:#ad0c62!important}.pma[_ngcontent-%COMP%]   .btn-mm-p[_ngcontent-%COMP%]{background-color:#ad0c62;font-size:16px;cursor:pointer;border-radius:10px;color:#fff;font-weight:500;padding:10px 104px!important;width:100%}.pma[_ngcontent-%COMP%]   .btn-mm-p[_ngcontent-%COMP%]:hover{opacity:.9}.pma[_ngcontent-%COMP%]   .succ-mes[_ngcontent-%COMP%]{font-size:50px!important;font-weight:500!important}.pma[_ngcontent-%COMP%]   .thankyou-text[_ngcontent-%COMP%]{font-family:Lato;font-style:normal;font-weight:300;font-size:18px;line-height:22px;text-align:center;color:#545454}.progress-bar[_ngcontent-%COMP%]{background-color:#ad0c62!important}.progress[_ngcontent-%COMP%]{height:10px!important}.form-control[_ngcontent-%COMP%]{height:50px!important;font-size:20px}input[_ngcontent-%COMP%] + label[_ngcontent-%COMP%]{font-size:25px}.custom-control-label[_ngcontent-%COMP%]:after, .custom-control-label[_ngcontent-%COMP%]:before{width:2.5rem!important;height:2.5rem!important}.custom-control-label[_ngcontent-%COMP%]{padding-left:2.5rem!important;margin:10px 0}.custom-control-input[_ngcontent-%COMP%]:checked ~ .custom-control-label[_ngcontent-%COMP%]:before{background-color:#ad0c62!important;border-color:#ad0c62!important}.pma-buttons[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{font-family:Lato;font-style:normal;font-weight:500;font-size:20px;line-height:24px;text-align:center}.my_streaks[_ngcontent-%COMP%]   .my_streaks-img[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{height:150px;display:inline-block}.my_streaks[_ngcontent-%COMP%]   .survey-heading[_ngcontent-%COMP%]{color:#ad0c62;font-size:24px}.my_streaks[_ngcontent-%COMP%]   .vertical-line[_ngcontent-%COMP%]{height:870px;width:30px;background-color:#d9d9d9;border-radius:50px}.my_streaks[_ngcontent-%COMP%]   .line-border[_ngcontent-%COMP%]{border-radius:50px}.my_streaks[_ngcontent-%COMP%]   .vertical-line-progress[_ngcontent-%COMP%]{border-radius:50px;background:linear-gradient(to bottom,#18BA32 170px,#AF2A74 170px)}.my_streaks[_ngcontent-%COMP%]   .completed-verticalline-bg[_ngcontent-%COMP%]{background-color:#18ba32}.my_streaks[_ngcontent-%COMP%]   .common-circle[_ngcontent-%COMP%]{border-radius:50%;width:120px;height:120px;display:flex;justify-content:center;align-items:center;align-content:center;font-size:14px}.my_streaks[_ngcontent-%COMP%]   .common-circle-top[_ngcontent-%COMP%]{margin-top:30px!important}.my_streaks[_ngcontent-%COMP%]   .circle-first-active[_ngcontent-%COMP%]{background-color:#af2a74;border:15px solid #CA5797;color:#fff}.my_streaks[_ngcontent-%COMP%]   .circle-final-active[_ngcontent-%COMP%]{background-color:#a31664;border:15px solid #C11374;color:#fff}.my_streaks[_ngcontent-%COMP%]   .circle-inactive[_ngcontent-%COMP%]{background-color:#e9e8e8;border:15px solid #F1F0F0;color:#000}.my_streaks[_ngcontent-%COMP%]   .circle-completed[_ngcontent-%COMP%]{background-color:#18ba32;border:15px solid #7ADF8A}.my_streaks[_ngcontent-%COMP%]   .positioning[_ngcontent-%COMP%]{position:absolute;top:0;left:0;margin-left:-46px;right:0}.my_streaks[_ngcontent-%COMP%]   .left-51[_ngcontent-%COMP%]{left:-51px}.my_streaks[_ngcontent-%COMP%]   .survey-timedate-fs[_ngcontent-%COMP%]{display:flex;flex-direction:column;margin-left:19px;max-width:100%}.my_streaks[_ngcontent-%COMP%]   .survey-timedate-fs[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font-size:16px}.my_streaks[_ngcontent-%COMP%]   .survey-timedate-fs[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]:first-child{width:100px}.my_streaks[_ngcontent-%COMP%]   .survey-timedate-fs[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]:last-child{width:140px}.my_streaks[_ngcontent-%COMP%]   .text-lightgrey[_ngcontent-%COMP%]{color:#545454!important}"]}),n})()},{path:"**",redirectTo:"list",pathMatch:"full"}]}];let k=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=e.\u0275\u0275defineNgModule({type:n}),n.\u0275inj=e.\u0275\u0275defineInjector({imports:[[v.Bz.forChild(I)],v.Bz]}),n})();var T=d(4466);let L=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=e.\u0275\u0275defineNgModule({type:n}),n.\u0275inj=e.\u0275\u0275defineInjector({imports:[[g.ez,k,T.m]]}),n})()}}]);